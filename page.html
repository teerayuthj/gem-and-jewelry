<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Page</title>
    
    <!-- Tailwind CSS + daisyUI CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="./assets/css/banner-slideshow.css">
    <link rel="stylesheet" href="./assets/css/gold-price.css">
    <link rel="stylesheet" href="./assets/css/main.css">
    <link rel="stylesheet" href="./assets/css/countdown.css">
    <!-- Calculator -->
    <link rel="stylesheet" href="./assets/css/calculator.css">
    
    <style>
        /* Global Styles */
        body, html {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background-color: #E8F4FD;
            min-height: 100vh;
        }
        
        /* Banner Section Fixes */
        .banner-slideshow {
            position: relative !important;
            isolation: isolate;
            z-index: 1;
        }
        
        .banner-slideshow:nth-child(n+2) {
            display: none !important;
        }
        
        .banner-content {
            background: rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: blur(2px) !important;
            border: 1px solid rgba(255, 255, 255, 0.25) !important;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3) !important;
        }
        
        .banner-title {
            text-shadow: 3px 3px 10px rgba(0,0,0,0.9) !important;
            font-weight: 900 !important;
        }
        
        .banner-subtitle {
            text-shadow: 2px 2px 6px rgba(0,0,0,0.8) !important;
            font-weight: 700 !important;
        }
        
        .banner-overlay {
            background: linear-gradient(135deg, rgba(0,0,0,0.25) 0%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.15) 100%) !important;
        }
        
        /* Section Spacing */
        .section-spacing {
            padding: 2rem 0;
        }
        
        /* Unified Language Button */
        .unified-lang-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            border: 2px solid #3B82F6;
            color: #3B82F6;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .unified-lang-btn:hover {
            background: #3B82F6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        
        /* Loading animation */
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Language transition effects */
        .language-transition {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        .language-changing {
            opacity: 0.7;
            transform: scale(0.98);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .unified-lang-btn {
                top: 15px;
                right: 15px;
                padding: 8px 16px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Unified Language Switcher - Hidden, will be controlled by banner -->
    <!-- <button id="unifiedLangSwitcher" class="unified-lang-btn">
        English
    </button> -->
    
    <!-- Section 1: Banner Slideshow -->
    <section id="bannerSection" class="">
        <div class="banner-slideshow" id="mainBanner">
            <!-- Content will be injected by JavaScript -->
        </div>
    </section>
    
    <!-- Section 2: Gold Price Component -->
    <section id="goldPriceSection" class="section-spacing language-transition">
        <div class="container mx-auto">
            <div id="goldPriceContainer" class="gold-price-container">
                <!-- Gold price component will be rendered here -->
            </div>
        </div>
    </section>

    <!-- Section 2.5: Gold Calculator Component -->
    <div id="calculator-app"></div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        new GemApp.GoldSilverCalculator('calculator-app');
    });
    </script>
    <!-- Section 3: Special Offer Section -->
    <section id="specialOfferSection" class="section-spacing language-transition">
        <div class="hero">
            <div class="hero-content text-center w-full">
                <div class="w-full max-w-sm md:max-w-md lg:max-w-lg mx-auto">
                    <!-- Offer Header -->
                    <div class="card bg-primary text-primary-content shadow-2xl">
                        <div class="card-body">
                            <h1 class="card-title text-2xl md:text-4xl lg:text-5xl font-bold justify-center mb-2" data-i18n="offer.header">
                                üéâ ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô! üéâ
                            </h1>
                            <p class="text-base md:text-lg lg:text-xl mb-3" data-i18n="offer.description">
                                ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 100 ‡∏ö‡∏≤‡∏ó
                            </p>
                            
                            <!-- Discount Code Section -->
                            <div class="card bg-base-100 text-base-content shadow-lg mb-4">
                                <div class="card-body">
                                    <h3 class="card-title text-lg md:text-xl lg:text-2xl justify-center text-accent" data-i18n="offer.codeTitle">
                                        üè∑Ô∏è ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î
                                    </h3>
                                    
                                    <div class="join w-full max-w-md mx-auto mt-3">
                                        <input 
                                            id="discountCode" 
                                            type="text" 
                                            value="AUS100TH" 
                                            readonly 
                                            class="input input-bordered input-accent join-item flex-1 text-center text-base md:text-lg font-bold"
                                            data-i18n-value="offer.discountCode"
                                        />
                                        <button 
                                            id="copyBtn"
                                            onclick="copyDiscountCode()" 
                                            class="btn btn-accent join-item copy-btn">
                                            <svg id="copyIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                            </svg>
                                            <svg id="checkIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                            <span id="btnText" data-i18n="offer.copyButton">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</span>
                                        </button>
                                    </div>
                                    
                                    <p class="text-warning font-semibold mt-2">
                                        <span data-i18n="offer.codeExpiry">‚è∞ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏:</span> <span id="expiryDate">28/07/2025</span>
                                    </p>
                                </div>
                            </div>
                            
                            <!-- Promotion Period -->
                            <div class="stats stats-vertical lg:stats-horizontal shadow mb-4">
                                <div class="stat">
                                    <div class="stat-title" data-i18n="offer.promotionPeriod">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</div>
                                    <div class="stat-value text-lg">
                                        <span id="startDate">30/06/2025</span> - <span id="endDate">28/07/2025</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Countdown Timer -->
                            <div class="mb-4">
                                <h3 class="text-lg md:text-xl lg:text-2xl font-bold mb-2" id="countdownLabel" data-i18n="countdown.label">
                                    ‚è≥ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏µ‡∏Å:
                                </h3>
                                
                                <!-- Enhanced Countdown with Urgency Effects -->
                                <div class="countdown-container">
                                    <div class="grid grid-flow-col gap-3 md:gap-4 lg:gap-5 text-center auto-cols-max justify-center">
                                        <div id="days-container" class="countdown-item flex flex-col p-3 md:p-3 lg:p-4 rounded-box text-white font-bold shadow-lg">
                                            <span class="countdown font-mono text-4xl md:text-4xl lg:text-5xl">
                                                <span id="countdown-days" style="--value:15;" aria-live="polite">15</span>
                                            </span>
                                            <span class="text-sm md:text-sm mt-1 font-semibold" data-i18n="countdown.days">‡∏ß‡∏±‡∏ô</span>
                                        </div>
                                        <div id="hours-container" class="countdown-item flex flex-col p-3 md:p-3 lg:p-4 rounded-box text-white font-bold shadow-lg">
                                            <span class="countdown font-mono text-4xl md:text-4xl lg:text-5xl">
                                                <span id="countdown-hours" style="--value:10;" aria-live="polite">10</span>
                                            </span>
                                            <span class="text-sm md:text-sm mt-1 font-semibold" data-i18n="countdown.hours">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</span>
                                        </div>
                                        <div id="minutes-container" class="countdown-item flex flex-col p-3 md:p-3 lg:p-4 rounded-box text-white font-bold shadow-lg">
                                            <span class="countdown font-mono text-4xl md:text-4xl lg:text-5xl">
                                                <span id="countdown-minutes" style="--value:24;" aria-live="polite">24</span>
                                            </span>
                                            <span class="text-sm md:text-sm mt-1 font-semibold" data-i18n="countdown.minutes">‡∏ô‡∏≤‡∏ó‡∏µ</span>
                                        </div>
                                        <div id="seconds-container" class="countdown-item flex flex-col p-3 md:p-3 lg:p-4 rounded-box text-white font-bold shadow-lg">
                                            <span class="countdown font-mono text-4xl md:text-4xl lg:text-5xl">
                                                <span id="countdown-seconds" style="--value:59;" aria-live="polite">59</span>
                                            </span>
                                            <span class="text-sm md:text-sm mt-1 font-semibold" data-i18n="countdown.seconds">‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Button -->
                            <button id="mainActionBtn" class="btn btn-accent main-action-btn text-white" data-i18n="buttons.getOffer">
                                üõí ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Scripts -->
    <script src="./assets/js/banner-slideshow.js"></script>
    <script src="./assets/js/i18n.js"></script>
    <script src="./assets/js/gold-price-manager.js"></script>
    <script src="./assets/js/thai-header-fix.js"></script>
    <script src="./assets/js/discount-manager.js"></script>
    <script src="./assets/js/countdown.js"></script>
    <script src="./assets/js/copy-function.js"></script>

    <!-- Calculator -->
    <script src="./assets/js/common.js"></script>
    <script src="./assets/js/calculator.js"></script>

    <script>
        // Unified Language Management
        class UnifiedLanguageManager {
            constructor() {
                this.currentLang = localStorage.getItem('language') || 'en';
                this.components = {
                    banner: null,
                    goldPrice: null,
                    specialOffer: null
                };
                this.init();
            }
            
            init() {
                this.updateLanguageButton();
                this.setupLanguageToggle();
                this.initializeComponents();
            }
            
            updateLanguageButton() {
                // Update unified button if exists (currently disabled)
                const button = document.getElementById('unifiedLangSwitcher');
                if (button) {
                    button.textContent = this.currentLang === 'th' ? '‡πÑ‡∏ó‡∏¢' : 'English';
                }
                
                // Update banner language button text if exists
                const bannerBtn = document.querySelector('#langSwitcher');
                if (bannerBtn) {
                    bannerBtn.textContent = this.currentLang === 'th' ? 'English' : 'Thai';
                }
            }
            
            setupLanguageToggle() {
                // Unified button is disabled, language control is handled by banner
                const button = document.getElementById('unifiedLangSwitcher');
                if (button) {
                    button.addEventListener('click', () => {
                        this.toggleLanguage();
                    });
                }
            }
            
            toggleLanguage() {
                this.currentLang = this.currentLang === 'th' ? 'en' : 'th';
                localStorage.setItem('language', this.currentLang);
                this.updateLanguageButton();
                this.broadcastLanguageChange();
            }
            
            broadcastLanguageChange() {
                console.log('Unified: Broadcasting language change to', this.currentLang);
                
                // Send unified language change event (components will handle this)
                document.dispatchEvent(new CustomEvent('unifiedLanguageChanged', {
                    detail: { language: this.currentLang }
                }));
            }
            
            updateSpecialOfferTranslations() {
                // This will be handled by the existing i18n system
                if (window.i18nManager) {
                    window.i18nManager.updateTranslations();
                }
            }
            
            async initializeComponents() {
                try {
                    // Initialize Banner Component
                    await this.initializeBanner();
                    
                    // Initialize other components
                    this.initializeGoldPrice();
                    this.initializeSpecialOffer();
                    
                    console.log('All components initialized successfully');
                } catch (error) {
                    console.error('Error initializing components:', error);
                }
            }
            
            async initializeBanner() {
                return new Promise((resolve) => {
                    const initBanner = () => {
                        const container = document.getElementById('mainBanner');
                        if (container && window.BannerSlideshow) {
                            try {
                                container.innerHTML = '';
                                container.className = 'banner-slideshow banner-initialized';
                                
                                const banner = new BannerSlideshow({
                                    container: container,
                                    autoPlayDuration: 6000
                                });
                                
                                this.components.banner = banner;
                                window.bannerSlideshow = banner;
                                
                                console.log('Banner slideshow initialized');
                                resolve(banner);
                            } catch (error) {
                                console.error('Banner initialization failed:', error);
                                resolve(null);
                            }
                        } else {
                            setTimeout(initBanner, 100);
                        }
                    };
                    
                    initBanner();
                });
            }
            
            initializeGoldPrice() {
                // Gold Price Manager should initialize automatically
                if (window.goldPriceManager) {
                    this.components.goldPrice = window.goldPriceManager;
                    console.log('Gold Price Manager ready');
                }
            }
            
            initializeSpecialOffer() {
                // Special offer components should initialize automatically
                if (window.i18nManager) {
                    this.components.specialOffer = window.i18nManager;
                    console.log('Special Offer Manager ready');
                }
            }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            window.unifiedLanguageManager = new UnifiedLanguageManager();
        });
        
        // Debug function
        window.debugUnified = () => {
            console.log('Unified Language Manager:', window.unifiedLanguageManager);
            console.log('Current Language:', window.unifiedLanguageManager?.currentLang);
            console.log('Components:', window.unifiedLanguageManager?.components);
        };
        
        // Copy discount code function
        function copyDiscountCode() {
            const codeInput = document.getElementById('discountCode');
            const copyBtn = document.getElementById('copyBtn');
            const copyIcon = document.getElementById('copyIcon');
            const checkIcon = document.getElementById('checkIcon');
            const btnText = document.getElementById('btnText');
            
            if (codeInput) {
                codeInput.select();
                document.execCommand('copy');
                
                // Visual feedback
                copyIcon.classList.add('hidden');
                checkIcon.classList.remove('hidden');
                btnText.textContent = window.unifiedLanguageManager?.currentLang === 'th' ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!' : 'Copied!';
                
                setTimeout(() => {
                    copyIcon.classList.remove('hidden');
                    checkIcon.classList.add('hidden');
                    btnText.textContent = window.unifiedLanguageManager?.currentLang === 'th' ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å' : 'Copy';
                }, 2000);
            }
        }
    </script>
</body>
</html>